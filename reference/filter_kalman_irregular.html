<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Kalman Filter for Irregular Time Series with Optional Resampling — filter_kalman_irregular • animovement</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kalman Filter for Irregular Time Series with Optional Resampling — filter_kalman_irregular"><meta name="description" content="Implements a Kalman filter for irregularly sampled time series data with optional
resampling to regular intervals. Handles variable sampling rates, missing values,
and automatically adjusts process variance based on time intervals."><meta property="og:description" content="Implements a Kalman filter for irregularly sampled time series data with optional
resampling to regular intervals. Handles variable sampling rates, missing values,
and automatically adjusts process variance based on time intervals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">animovement</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/animovement.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorial" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorial</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorial"><li><a class="dropdown-item" href="../articles/read-trackball.html">Read trackball data</a></li>
    <li><a class="dropdown-item" href="../articles/clean-tracks.html">Clean tracks</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-kinematics.html">Calculate kinematics</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-summary-statistics.html">Calculate summary statistics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mission.html">Mission &amp; Scope</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Roadmaps</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>How to contribute</h6></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/roaldarbol/animovement/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Kalman Filter for Irregular Time Series with Optional Resampling</h1>
      <small class="dont-index">Source: <a href="https://github.com/roaldarbol/animovement/blob/main/R/filter_kalman.R" class="external-link"><code>R/filter_kalman.R</code></a></small>
      <div class="d-none name"><code>filter_kalman_irregular.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements a Kalman filter for irregularly sampled time series data with optional
resampling to regular intervals. Handles variable sampling rates, missing values,
and automatically adjusts process variance based on time intervals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_kalman_irregular</span><span class="op">(</span></span>
<span>  <span class="va">measurements</span>,</span>
<span>  <span class="va">times</span>,</span>
<span>  base_Q <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initial_state <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initial_P <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  resample_freq <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-measurements">measurements<a class="anchor" aria-label="anchor" href="#arg-measurements"></a></dt>
<dd><p>Numeric vector containing the measurements to be filtered.</p></dd>


<dt id="arg-times">times<a class="anchor" aria-label="anchor" href="#arg-times"></a></dt>
<dd><p>Numeric vector of timestamps corresponding to measurements.</p></dd>


<dt id="arg-base-q">base_Q<a class="anchor" aria-label="anchor" href="#arg-base-q"></a></dt>
<dd><p>Optional. Base process variance per second. If NULL, automatically calculated.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Optional. Measurement variance. If NULL, defaults to 0.1.</p></dd>


<dt id="arg-initial-state">initial_state<a class="anchor" aria-label="anchor" href="#arg-initial-state"></a></dt>
<dd><p>Optional. Initial state estimate. If NULL, uses first non-NA measurement.</p></dd>


<dt id="arg-initial-p">initial_P<a class="anchor" aria-label="anchor" href="#arg-initial-p"></a></dt>
<dd><p>Optional. Initial state uncertainty. If NULL, calculated from median sampling rate.</p></dd>


<dt id="arg-resample">resample<a class="anchor" aria-label="anchor" href="#arg-resample"></a></dt>
<dd><p>Logical. Whether to return regularly resampled data (default: FALSE).</p></dd>


<dt id="arg-resample-freq">resample_freq<a class="anchor" aria-label="anchor" href="#arg-resample-freq"></a></dt>
<dd><p>Numeric. Desired sampling frequency in Hz for resampling (required if resample=TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If resample=FALSE:
A numeric vector of filtered values corresponding to original timestamps
If resample=TRUE:
A list containing:</p><ul><li><p>time: Vector of regular timestamps</p></li>
<li><p>values: Vector of filtered values at regular timestamps</p></li>
<li><p>original_time: Original irregular timestamps</p></li>
<li><p>original_values: Filtered values at original timestamps</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements an adaptive Kalman filter that accounts for irregular
sampling intervals. Process variance is scaled by the time difference between
measurements, allowing proper uncertainty handling for variable sampling rates.</p>
<p>Key features:</p><ul><li><p>Handles irregular sampling intervals</p></li>
<li><p>Scales process variance with time gaps</p></li>
<li><p>Optional resampling to regular intervals</p></li>
<li><p>Automatic parameter selection based on median sampling rate</p></li>
<li><p>Missing value (NA) handling</p></li>
</ul><p>When resampling, the function uses linear interpolation and warns if the requested
sampling frequency exceeds twice the median original sampling rate (Nyquist frequency).</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Resampling considerations:</p><ul><li><p>Avoid resampling above twice the median original sampling rate</p></li>
<li><p>Consider the physical meaning of your data when choosing resample_freq</p></li>
<li><p>Be cautious of creating artifacts through high-frequency resampling</p></li>
</ul><p>Parameter selection guidelines:</p><ul><li><p>base_Q controls the expected rate of change per second</p></li>
<li><p>R should reflect your measurement noise level</p></li>
<li><p>For slow-changing signals, reduce base_Q</p></li>
<li><p>For noisy measurements, increase R</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>filter_kalman for regularly sampled data</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example with irregular sampling</span></span></span>
<span class="r-in"><span><span class="va">measurements</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.1</span>, <span class="cn">NA</span>, <span class="fl">0.9</span>, <span class="fl">1.2</span>, <span class="cn">NA</span>, <span class="fl">0.8</span>, <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.81</span>, <span class="fl">1.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic filtering with irregular samples</span></span></span>
<span class="r-in"><span><span class="va">filtered</span> <span class="op">&lt;-</span> <span class="fu">filter_kalman_irregular</span><span class="op">(</span><span class="va">measurements</span>, <span class="va">times</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Filtering with resampling to 50 Hz</span></span></span>
<span class="r-in"><span><span class="va">filtered_resampled</span> <span class="op">&lt;-</span> <span class="fu">filter_kalman_irregular</span><span class="op">(</span><span class="va">measurements</span>, <span class="va">times</span>,</span></span>
<span class="r-in"><span>                                             resample <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                                             resample_freq <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Requested resampling frequency (50 Hz) exceeds twice the median sampling rate (6.66667 Hz).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>             This may lead to poor interpolation.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">measurements</span>, type<span class="op">=</span><span class="st">"p"</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">filtered_resampled</span><span class="op">$</span><span class="va">time</span>, <span class="va">filtered_resampled</span><span class="op">$</span><span class="va">values</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="filter_kalman_irregular-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://roald-arboel.com" class="external-link">Mikkel Roald-Arbøl</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

