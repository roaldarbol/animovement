<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply Savitzky-Golay Filter to Movement Data — filter_sgolay • animovement</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply Savitzky-Golay Filter to Movement Data — filter_sgolay"><meta name="description" content="This function applies a Savitzky-Golay filter to smooth movement data while preserving
higher moments (peaks, valleys) better than moving average filters. The implementation
uses zero-phase filtering to prevent temporal shifts in the data."><meta property="og:description" content="This function applies a Savitzky-Golay filter to smooth movement data while preserving
higher moments (peaks, valleys) better than moving average filters. The implementation
uses zero-phase filtering to prevent temporal shifts in the data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">animovement</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/animovement.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorial" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorial</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorial"><li><a class="dropdown-item" href="../articles/read-trackball.html">Read trackball data</a></li>
    <li><a class="dropdown-item" href="../articles/clean-tracks.html">Clean tracks</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-kinematics.html">Calculate kinematics</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-summary-statistics.html">Calculate summary statistics</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mission.html">Mission &amp; Scope</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Roadmaps</h6></li>
    <li><h6 class="dropdown-header" data-toc-skip>How to contribute</h6></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/roaldarbol/animovement/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply Savitzky-Golay Filter to Movement Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/roaldarbol/animovement/blob/main/R/filter_sgolay.R" class="external-link"><code>R/filter_sgolay.R</code></a></small>
      <div class="d-none name"><code>filter_sgolay.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function applies a Savitzky-Golay filter to smooth movement data while preserving
higher moments (peaks, valleys) better than moving average filters. The implementation
uses zero-phase filtering to prevent temporal shifts in the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_sgolay</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">sampling_rate</span>,</span>
<span>  window_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">sampling_rate</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>  order <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  preserve_edges <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  na_action <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>  keep_na <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Numeric vector containing the movement data to be filtered</p></dd>


<dt id="arg-sampling-rate">sampling_rate<a class="anchor" aria-label="anchor" href="#arg-sampling-rate"></a></dt>
<dd><p>Sampling rate of the data in Hz. Must match your data
collection rate (e.g., 60 for 60 FPS motion capture).</p></dd>


<dt id="arg-window-size">window_size<a class="anchor" aria-label="anchor" href="#arg-window-size"></a></dt>
<dd><p>Window size in samples (must be odd). Controls the amount of
smoothing. Larger windows give more smoothing but may over-attenuate
genuine movement features. Default is automatically calculated as
sampling_rate/10 (rounded up to nearest odd number).</p></dd>


<dt id="arg-order">order<a class="anchor" aria-label="anchor" href="#arg-order"></a></dt>
<dd><p>Polynomial order (default = 3). Controls how well the filter preserves
higher-order moments in the data:
- order=2: Preserves position, velocity (good for smooth movements)
- order=3: Also preserves acceleration (good for most movement data)
- order=4: Also preserves jerk (good for quick movements)
- order=5: Maximum preservation (may retain too much noise)</p></dd>


<dt id="arg-preserve-edges">preserve_edges<a class="anchor" aria-label="anchor" href="#arg-preserve-edges"></a></dt>
<dd><p>Logical indicating whether to use progressively smaller windows
at the beginning and end of the signal to reduce edge effects (default = FALSE).
Note: This only affects the signal endpoints, not internal discontinuities.</p></dd>


<dt id="arg-na-action">na_action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Method to handle NA values before filtering. One of:
- "linear": Linear interpolation (default)
- "spline": Spline interpolation for smoother curves
- "locf": Last observation carried forward
- "value": Replace with a constant value
- "error": Raise an error if NAs are present</p></dd>


<dt id="arg-keep-na">keep_na<a class="anchor" aria-label="anchor" href="#arg-keep-na"></a></dt>
<dd><p>Logical indicating whether to restore NAs to their original positions
after filtering (default = FALSE)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to replace_na()</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric vector containing the filtered movement data</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Savitzky-Golay filter fits successive polynomials to sliding windows of the data.
This approach preserves higher moments of the data better than simple moving averages
or Butterworth filters, making it particularly suitable for movement data where
preserving features like peaks and valleys is important.</p>
<p>Edge Handling:
When preserve_edges = TRUE, the function uses progressively smaller windows near the
beginning and end of the signal to reduce endpoint distortion. This only affects
the signal endpoints - it does not detect or handle internal discontinuities or
sharp events within the data.</p>
<p>Parameter Selection Guidelines:</p><ul><li><p>window_size:</p><ul><li><p>For 60 FPS: 5-15 frames (83-250ms) for quick movements, 15-31 for slow movements</p></li>
<li><p>For 120 FPS: 7-21 frames (58-175ms) for quick movements, 21-51 for slow movements</p></li>
<li><p>For 500 FPS: 25-75 frames (50-150ms) for quick movements, 75-151 for slow movements
The default window_size = sampling_rate/10 works well for typical human movement.</p></li>
</ul></li>
<li><p>order:</p><ul><li><p>order=2: Smooth movements, position analysis</p></li>
<li><p>order=3: Most movement analysis (default)</p></li>
<li><p>order=4: Quick movements, sports analysis</p></li>
<li><p>order=5: Very quick movements, impact analysis
Note: order must be less than window_size</p></li>
</ul></li>
</ul><p>Common values by application:</p><ul><li><p>Gait analysis (60 FPS): window_size=15, order=3</p></li>
<li><p>Sports biomechanics (120 FPS): window_size=21, order=4</p></li>
<li><p>Impact analysis (500 FPS): window_size=51, order=4</p></li>
<li><p>Posture analysis (60 FPS): window_size=31, order=2</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Savitzky, A., &amp; Golay, M.J.E. (1964). Smoothing and Differentiation of Data by
Simplified Least Squares Procedures. Analytical Chemistry, 36(8), 1627-1639.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="filter_lowpass.html">filter_lowpass</a></code> for frequency-based filtering
<code>sgolayfilt</code> for the base Savitzky-Golay implementation
<code><a href="replace_na.html">replace_na</a></code> for details on NA handling methods</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Generate example movement data: smooth motion + noise</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span>  <span class="co"># 60 FPS data</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">0.5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic filtering with default parameters (60 FPS)</span></span></span>
<span class="r-in"><span><span class="va">filtered</span> <span class="op">&lt;-</span> <span class="fu">filter_sgolay</span><span class="op">(</span><span class="va">x</span>, sampling_rate <span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adjusting parameters for quick movements</span></span></span>
<span class="r-in"><span><span class="va">filtered_quick</span> <span class="op">&lt;-</span> <span class="fu">filter_sgolay</span><span class="op">(</span><span class="va">x</span>, sampling_rate <span class="op">=</span> <span class="fl">60</span>,</span></span>
<span class="r-in"><span>                               window_size <span class="op">=</span> <span class="fl">11</span>, order <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># High-speed camera data (500 FPS) with larger window</span></span></span>
<span class="r-in"><span><span class="va">filtered_high</span> <span class="op">&lt;-</span> <span class="fu">filter_sgolay</span><span class="op">(</span><span class="va">x</span>, sampling_rate <span class="op">=</span> <span class="fl">500</span>,</span></span>
<span class="r-in"><span>                              window_size <span class="op">=</span> <span class="fl">51</span>, order <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://roald-arboel.com" class="external-link">Mikkel Roald-Arbøl</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

