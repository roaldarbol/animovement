<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Read trackball data • animovement</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read trackball data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">animovement</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/animovement.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorial" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorial</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorial">
<li><a class="dropdown-item" href="../articles/read-trackball.html">Read trackball data</a></li>
    <li><a class="dropdown-item" href="../articles/clean-tracks.html">Clean tracks</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-kinematics.html">Calculate kinematics</a></li>
    <li><a class="dropdown-item" href="../articles/calculate-summary-statistics.html">Calculate summary statistics</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/roaldarbol/animovement/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read trackball data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/roaldarbol/animovement/blob/v0.2.0-beta/vignettes/articles/read-trackball.Rmd" class="external-link"><code>vignettes/articles/read-trackball.Rmd</code></a></small>
      <div class="d-none name"><code>read-trackball.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.roald-arboel.com/animovement/">animovement</a></span><span class="op">)</span></span></code></pre></div>
<p>Trackball experiments, in which animals are tethered/restrained atop
a (most commonly) styrofoam ball are common experiments within animal
behaviour and neuroscience.</p>
<p>There are different ways to obtain data from trackball experiments,
and although we only currently support limited ways, we are looking
forward to supporting all your trackball experiments!</p>
<p>The main interface from your data to a standardised trackball data
frame is the <code><a href="../reference/read_trackball.html">read_trackball()</a></code> function. The most common
experimental setup uses two optical computer mics (or other optical flow
sensors), which detects movements of the ball at different axes and is
the primary experimental setup we support (although see our <a href="https://roald-arboel.com/trackballr#roadmap" class="external-link">roadmap</a>!). For
this experiment, <code><a href="../reference/read_trackball.html">read_trackball()</a></code> requires <strong>two file
paths, one for each sensor</strong>.</p>
<p>You can find pairs with variations of <code><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files()</a></code> and
for-loops. We’ll go through how to use <code><a href="../reference/read_trackball.html">read_trackball()</a></code> for
a single experimental trial, as well as a few ways of managing multiple
experimental trials at the same time.</p>
<div class="section level2">
<h2 id="the-read_trackball-function">The <code>read_trackball()</code> function<a class="anchor" aria-label="anchor" href="#the-read_trackball-function"></a>
</h2>
<p>We recommend keeping your analysis scripts and data in the same
project (which doesn’t mean folder), and to use the great <a href="https://here.r-lib.org/index.html" class="external-link">here</a> package package to
manage your files (see their documentation to learn more about it).</p>
<p>First, we’ll let R know which is our project root folder.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; here() starts at /home/runner/work/animovement/animovement</span></span>
<span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/i_am.html" class="external-link">i_am</a></span><span class="op">(</span><span class="st">"vignettes/articles/read-trackball.Rmd"</span><span class="op">)</span></span>
<span><span class="co">#&gt; here() starts at /home/runner/work/animovement/animovement</span></span></code></pre></div>
<p>Our data lives in a funky place (because of the constraints of being
in an R package), but giving file paths is easy.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filepath_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"tests"</span>, <span class="st">"data"</span>, <span class="st">"single"</span>, <span class="st">"opticalflow_sensor_1.csv"</span><span class="op">)</span></span>
<span><span class="va">filepath_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"tests"</span>, <span class="st">"data"</span>, <span class="st">"single"</span>, <span class="st">"opticalflow_sensor_2.csv"</span><span class="op">)</span></span>
<span><span class="va">filepaths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">filepath_1</span>, <span class="va">filepath_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># These might be something like: here("data", "trackball", "sensor_1", "trackballdata_100.csv") for you!</span></span></code></pre></div>
<p>Great, now we have our file paths. But the function needs to know a
few more things.</p>
<ul>
<li>
<strong>Experimental configuration</strong>
<ul>
<li>Takes either <code>"free"</code> or <code>"fixed"</code>.</li>
</ul>
</li>
<li>
<strong>Time column</strong>
<ul>
<li>Which column contains time stamps in either seconds or datetime
format (takes either column number or name in quotes,
e.g. <code>4</code> or <code>"time"</code>)</li>
</ul>
</li>
<li>
<strong>Sampling rate</strong>
<ul>
<li>This <em>can</em> be your actual sampling rate, but we use this
information to bin observations, so you can easily choose a lower
sampling rate.</li>
</ul>
</li>
<li>
<strong>Mouse Dots-per-cm (DPCM)</strong>
<ul>
<li>This value is optional, but if provided is used to convert your
spatial estimates from unit-less to centimeters. Can be found for most
computer mice.</li>
</ul>
</li>
</ul>
<p>Let’s try to read our provided files:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_trackball.html">read_trackball</a></span><span class="op">(</span></span>
<span>  <span class="va">filepaths</span>, </span>
<span>  setup <span class="op">=</span> <span class="st">"of_free"</span>,</span>
<span>  col_time <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  sampling_rate <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  distance_scale <span class="op">=</span> <span class="fl">394</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-multiple-experiments">Working with multiple experiments<a class="anchor" aria-label="anchor" href="#working-with-multiple-experiments"></a>
</h2>
<p>When working with multiple experimental trials, there are multiple
ways of reading all the data whilst keeping track of all the important
information. Here we’ll cover a few ways that are supported by
<em>animovement</em>.</p>
<ul>
<li>
<a href="#from-metadata"><strong>Read from from metadata
file</strong></a>.
<ul>
<li>
<em>When to use</em>: File names contain little or no
information.</li>
</ul>
</li>
<li>
<a href="#from-filenames"><strong>Read from file names</strong></a>.
<ul>
<li>
<em>When to use</em>: File names contain enough information that can
be used to distinguish between experiments.</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="from-metadata">Read from metadata file<a class="anchor" aria-label="anchor" href="#from-metadata"></a>
</h3>
<p><strong><em>When to use</em></strong>: File names contain little or
no information.</p>
<p>In this scenario we use a spreadsheet to keep track of which files go
together. We have an <code>.xlsx</code> file that contains the correct
pairs of file names. Let’s begin by reading and inspecting the file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org" class="external-link">readxl</a></span><span class="op">)</span></span>
<span><span class="va">metadata_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"multi"</span>, <span class="st">"trackball_filenames.xlsx"</span><span class="op">)</span></span>
<span><span class="va">metadata_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html" class="external-link">read_xlsx</a></span><span class="op">(</span><span class="va">metadata_path</span><span class="op">)</span></span>
<span><span class="va">metadata_file</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   identity date                filename_a                      filename_b       </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A100     2021-08-05 <span style="color: #949494;">00:00:00</span> GB_COM6_2021-08-05T15_37_55.csv GB_COM7_2021-08-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> A100     2021-08-12 <span style="color: #949494;">00:00:00</span> GB_COM6_2021-08-12T15_37_55.csv GB_COM7_2021-08-…</span></span></code></pre></div>
<p>We can then import our data, one experiment after the other. Again,
we use the <em>here</em> package to make file management easier.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First, we'll create an empty data frame which we'll read our data into</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then we loop through the rows in the metadata file</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">metadata_file</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Like before, change the path to match your local file structure</span></span>
<span>  <span class="va">file_primary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"multi"</span>, <span class="va">metadata_file</span><span class="op">$</span><span class="va">filename_a</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">file_secondary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"inst"</span>, <span class="st">"extdata"</span>, <span class="st">"multi"</span>, <span class="va">metadata_file</span><span class="op">$</span><span class="va">filename_b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Then we'll read all the file</span></span>
<span>  <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_trackball.html">read_trackball</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">file_primary</span>, <span class="va">file_secondary</span><span class="op">)</span>, </span>
<span>    setup <span class="op">=</span> <span class="st">"of_free"</span>,</span>
<span>    col_time <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    sampling_rate <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    distance_scale <span class="op">=</span> <span class="fl">394</span></span>
<span>    <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># And we can add other metadata, such as the identity and date to distinguish between experiments</span></span>
<span>  <span class="va">df_temp</span> <span class="op">&lt;-</span> <span class="va">df_temp</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="va">metadata_file</span><span class="op">$</span><span class="va">identity</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, </span>
<span>      date <span class="op">=</span> <span class="va">metadata_file</span><span class="op">$</span><span class="va">date</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Finally, we bind the data together</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">df_temp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="from-filenames">Read from file names<a class="anchor" aria-label="anchor" href="#from-filenames"></a>
</h3>
<p><strong><em>When to use</em></strong>: File names contain enough
information that can be used to distinguish between experiments.</p>
<p><strong>WORK IN PROGRESS!</strong></p>
<!-- Want to make life a little easier for yourself? So do we. Keeping track of many files can be tricky, but if you are conscious of how you name your files, you can make life a lot easier for yourself! -->
<!-- There are two key elements for enabling automatic import: -->
<!-- 1. Include enough metadata to identify the experiment -->
<!-- 2. Name files to ensure pairing of files is possible -->
<!-- *TL;DR* Include datetime in file name, reserve a character, e.g. `_` (underscore), for separating pieces of information. -->
<!-- - **GOOD**: `A101_2024-05-21T10-21-53` -->
<!-- - **BAD**: `A101_2024-05-21T10_21_53` -->
<!-- `ANIMALID_y-m-dT.csv` -->
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://roald-arboel.com" class="external-link">Mikkel Roald-Arbøl</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
