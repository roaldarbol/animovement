% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_bandwidth.R
\name{filter_lowpass}
\alias{filter_lowpass}
\title{Apply Butterworth Lowpass Filter to Signal}
\usage{
filter_lowpass(
  x,
  cutoff_freq,
  sampling_rate,
  order = 4,
  na_action = c("interpolate", "remove", "error")
)
}
\arguments{
\item{x}{Numeric vector containing the signal to be filtered}

\item{cutoff_freq}{Cutoff frequency in Hz. Frequencies below this value are passed,
while frequencies above are attenuated. Should be between 0 and sampling_rate/2.}

\item{sampling_rate}{Sampling rate of the signal in Hz. Must be at
least twice the highest frequency component in the signal (Nyquist criterion).}

\item{order}{Filter order (default = 4). Controls the steepness of frequency rolloff:
- Higher orders give sharper cutoffs but may introduce more ringing
- Lower orders give smoother transitions but less steep rolloff
- Common values in practice are 2-8
- Values above 8 are rarely used due to numerical instability}

\item{na_action}{How to handle NA values:
- "interpolate": Linear interpolation of NAs (default)
- "remove": Remove NAs and adjust time indices
- "error": Raise an error if NAs are present}
}
\value{
Numeric vector containing the filtered signal
}
\description{
This function applies a lowpass Butterworth filter to a signal using forward-backward
filtering (filtfilt) to achieve zero phase distortion. The Butterworth filter is
maximally flat in the passband, making it ideal for many signal processing applications.
}
\details{
The Butterworth filter response falls off at -6*order dB/octave. The cutoff frequency
corresponds to the -3dB point of the filter's magnitude response.

Parameter Selection Guidelines:
\itemize{
\item cutoff_freq: Choose based on the frequency content you want to preserve
\item sampling_rate: Should match your data collection rate
\item order:
\itemize{
\item order=2: Gentle rolloff, minimal ringing (~12 dB/octave)
\item order=4: Standard choice, good balance (~24 dB/octave)
\item order=6: Steeper rolloff, some ringing (~36 dB/octave)
\item order=8: Very steep, may have significant ringing (~48 dB/octave)
}
}

Common values by field:
\itemize{
\item Biomechanics: order=2 or 4
\item EEG/MEG: order=4 or 6
\item Audio processing: order=2 to 8
\item Mechanical vibrations: order=2 to 4
}

Missing Value Handling:
The function offers three approaches for handling NA values:
\itemize{
\item interpolate: Uses linear interpolation to fill gaps. Best for sporadic missing values.
Not recommended for large gaps as it may introduce artificial frequencies.
\item remove: Removes NA values and adjusts the time series accordingly. This changes the
effective sampling rate and may affect frequency content. Use with caution.
\item error: Stops execution if NAs are present. Use when missing values indicate a problem
that should be addressed before filtering.
}
}
\examples{
# Generate example signal: 2 Hz fundamental + 50 Hz noise
t <- seq(0, 1, by = 0.001)
x <- sin(2*pi*2*t) + 0.5*sin(2*pi*50*t)

# Apply lowpass filter to remove 50 Hz noise
filtered <- filter_lowpass(x, cutoff_freq = 5, sampling_rate = 1000, order = 4)

# Compare original and filtered signals
par(mfrow = c(2,1))
plot(t[1:100], x[1:100], type = "l", main = "Original Signal")
plot(t[1:100], filtered[1:100], type = "l", main = "Filtered Signal")

}
\references{
Butterworth, S. (1930). On the Theory of Filter Amplifiers.
Wireless Engineer, 7, 536-541.
}
\seealso{
\code{\link{highpass_filter}} for high-pass filtering
\code{\link{butter}} for Butterworth filter design
\code{\link{filtfilt}} for zero-phase digital filtering
}
