% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/filter_kalman.R
\name{filter_kalman_irregular}
\alias{filter_kalman_irregular}
\title{Kalman Filter for Irregular Time Series with Optional Resampling}
\usage{
filter_kalman_irregular(
  measurements,
  times,
  base_Q = NULL,
  R = NULL,
  initial_state = NULL,
  initial_P = NULL,
  resample = FALSE,
  resample_freq = NULL
)
}
\arguments{
\item{measurements}{Numeric vector containing the measurements to be filtered.}

\item{times}{Numeric vector of timestamps corresponding to measurements.}

\item{base_Q}{Optional. Base process variance per second. If NULL, automatically calculated.}

\item{R}{Optional. Measurement variance. If NULL, defaults to 0.1.}

\item{initial_state}{Optional. Initial state estimate. If NULL, uses first non-NA measurement.}

\item{initial_P}{Optional. Initial state uncertainty. If NULL, calculated from median sampling rate.}

\item{resample}{Logical. Whether to return regularly resampled data (default: FALSE).}

\item{resample_freq}{Numeric. Desired sampling frequency in Hz for resampling (required if resample=TRUE).}
}
\value{
If resample=FALSE:
A numeric vector of filtered values corresponding to original timestamps
If resample=TRUE:
A list containing:
\itemize{
\item time: Vector of regular timestamps
\item values: Vector of filtered values at regular timestamps
\item original_time: Original irregular timestamps
\item original_values: Filtered values at original timestamps
}
}
\description{
Implements a Kalman filter for irregularly sampled time series data with optional
resampling to regular intervals. Handles variable sampling rates, missing values,
and automatically adjusts process variance based on time intervals.
}
\details{
The function implements an adaptive Kalman filter that accounts for irregular
sampling intervals. Process variance is scaled by the time difference between
measurements, allowing proper uncertainty handling for variable sampling rates.

Key features:
\itemize{
\item Handles irregular sampling intervals
\item Scales process variance with time gaps
\item Optional resampling to regular intervals
\item Automatic parameter selection based on median sampling rate
\item Missing value (NA) handling
}

When resampling, the function uses linear interpolation and warns if the requested
sampling frequency exceeds twice the median original sampling rate (Nyquist frequency).
}
\note{
Resampling considerations:
\itemize{
\item Avoid resampling above twice the median original sampling rate
\item Consider the physical meaning of your data when choosing resample_freq
\item Be cautious of creating artifacts through high-frequency resampling
}

Parameter selection guidelines:
\itemize{
\item base_Q controls the expected rate of change per second
\item R should reflect your measurement noise level
\item For slow-changing signals, reduce base_Q
\item For noisy measurements, increase R
}
}
\examples{
# Example with irregular sampling
measurements <- c(1, 1.1, NA, 0.9, 1.2, NA, 0.8, 1.1)
times <- c(0, 0.1, 0.3, 0.35, 0.5, 0.8, 0.81, 1.0)

# Basic filtering with irregular samples
filtered <- filter_kalman_irregular(measurements, times)

# Filtering with resampling to 50 Hz
filtered_resampled <- filter_kalman_irregular(measurements, times,
                                             resample = TRUE,
                                             resample_freq = 50)

# Plot results
plot(times, measurements, type="p", col="blue")
lines(filtered_resampled$time, filtered_resampled$values, col="red")

}
\seealso{
filter_kalman for regularly sampled data
}
